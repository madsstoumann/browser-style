<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Layout Composer</title>
	<style>
		body {
			background: Canvas;
			color: CanvasText;
			color-scheme: light dark;
			margin: 0 2ch;
		}

/* === Tab Group === */
@scope (tab-group) {
	@property --tab-group-index {
		syntax: "<integer>";
		inherits: true;
		initial-value: 1;
	}
	:scope {
		--tab-group-accent: light-dark(hsl(210, 100%, 45%), hsl(210, 100%, 75%));
		--tab-group-bdrs: 3rem;
		--tab-group-gap: 1ch;
		container-type: inline-size;
		display: block;
	}
	details {
		--tab-group-index: sibling-index();
		&[open] summary {
			color: var(--tab-group-accent);
			-webkit-text-stroke: 0.5px currentColor;
			paint-order: stroke fill;
		}
	}
	summary {
		background: var(--layout-composer-tabs-bg, light-dark(#EEE, #222));
		border-radius: var(--tab-group-bdrs);
		color: var(--tabs-group-c, inherit);
		corner-shape: superellipse(1.25);
		cursor: pointer;
		display: grid;
		font-family: var(--tab-group-ff, inherit);
		font-size: var(--tab-group-fs, clamp(.75rem, 2.5vw, 1rem));
		grid-column: var(--tab-group-index);
		grid-row: 1;
		isolation: isolate;
		list-style: none;
		padding: var(--tab-group-p, 1.25ch);
		position: relative;
		text-align: var(--tabl-group-tal, center);
		text-box: cap alphabetic;
	 	/* text-decoration: underline; */
    /* text-decoration-thickness: var(--tab-group-tdt, 3px);
    text-underline-offset: 1rem; */
		transition: all .2s ease;
		user-select: none;
		&:focus-visible {
			outline-color: var(--tab-group-accent);
			outline-offset: -4px;
		}
	}
	tab-container {
		display: grid;
		padding-block: var(--tab-group-gap);
		row-gap: var(--tab-group-gap);
	}

	@container (width > 700px) {
		details {
			display: grid;
			grid-column: 1 / -1;
			grid-row: 1 / span 2;
			grid-template-columns: subgrid;
			grid-template-rows: subgrid;
			&:not(:first-of-type):not(:last-of-type) summary { border-radius: 0; }
			&:first-of-type summary { border-radius: var(--tab-group-bdrs) 0 0 var(--tab-group-bdrs); }
			&:last-of-type summary { border-radius: 0 var(--tab-group-bdrs) var(--tab-group-bdrs) 0; }
		}
		details::details-content {
			grid-column: 1 / -1;
			grid-row: 2;
		}
		tab-container {
			--tab-group-gap: var(--tab-group-desktop-gap, 2ch);
			grid-template-columns: repeat(var(--tab-group-tabs, 1), 1fr);
			grid-template-rows: auto 1fr;
			row-gap: 0;
		}
	}
}

/* === Layout Composer === */
@layer layout.composer {
	layout-composer {
		--layout-composer-accent: light-dark(hsl(210, 100%, 45%), hsl(210, 100%, 75%));
		--layout-composer-gap: 1ch;

		font-family: var(--layout-composer-ff, system-ui, sans-serif);
		display: grid;
		grid-template-rows: auto 1fr;
		height: 100vh;

		fieldset {
			border: none;
			display: flex;
			flex-wrap: wrap;
			gap: var(--layout-composer-gap);
			margin: 0;
			padding: var(--layout-composer-gap);
			position: relative;
			z-index: 1;
		}
		iframe {
			border: 1px dotted light-dark(#AAA, #555);
			height: 100%;
			margin-inline: auto;
			padding-block: var(--layout-composer-gap);
			transition: width 0.3s ease;
			width: 100%;
		}
		input, select {
			border: 1px solid #CCC;
			font-size: inherit;
			padding: .75ch;
		}
		input[type="radio"] {
			position: absolute;
			width: 1px;
			height: 1px;
			padding: 0;
			margin: -1px;
			overflow: hidden;
			clip: rect(0, 0, 0, 0);
			white-space: nowrap;
			border-width: 0;
		}
		label {
			display: grid;
			flex: 1;
			font-size: small;
			font-weight: 500;
			row-gap: .5ch;
			text-wrap: nowrap;
			&:has(:checked):has(svg) {
				color: var(--layout-composer-accent);
			}
		}
		svg {
			fill: none;
			stroke-linecap: round;
			stroke-linejoin: round;
			stroke-width: 1.5;
			stroke: currentColor;
			width: 2em;
		}
		[name="iframe-width"] {
			place-self: center;
			label { text-align: center; }
		}
	}
}
	 </style>
</head>
<body>
<!-- <img src="../../../dist/icons/grid(3a).svg" />
<img src="../../../dist/icons/grid(3b).svg" />
<img src="../../../dist/icons/grid(3c).svg" /> -->

<layout-composer>
	<form id="app">
		<tab-group>
			<tab-container>
				<details name="tabs" open>
					<summary>Breakpoints</summary>
					<fieldset name="breakpoints">
						<label>Small
							<select name="sm">
								<option value="unset">None</option>
								<optgroup label="Columns"></optgroup>
								<option value="columns(2)">columns(2)</option>
								</select>
						</label>

						<label>Medium
							<select name="md">
								<option value="unset">None</option>
								<optgroup label="Columns"></optgroup>
								<option value="columns(2)">columns(2)</option>
								<option value="columns(3)">columns(3)</option>
								<option value="columns(4)">columns(4)</option>
								
								<optgroup label="Grid"></optgroup>
								
								<option value="grid(3a)" data-items="3">grid(3a)</option>
								<option value="grid(3b)">grid(3b)</option>
								<option value="grid(3c)">grid(3c)</option>
								<option value="grid(3d)" >grid(3d)</option>
							</select>
						</label>
						<label>Large
							<select name="lg">
								<optgroup label="Grid"></optgroup>
								<option value="unset">None</option>
								<option value="grid(3a)" data-items="3">grid(3a)</option>
								<option value="grid(3b)">grid(3b)</option>
								<option value="grid(3c)">grid(3c)</option>
								<option value="grid(3d)">grid(3d)</option>
							</select>
						</label>

					</fieldset>
				</details>

				<details name="tabs">
					<summary>Spacing</summary>
					<fieldset name="spacing">
						<label>
							Space Top
							<input type="number" name="space-top" value="0" min="0">
						</label>
						<label>
							Space Bottom
							<input type="number" name="space-bottom" value="0" min="0">
						</label>
						<label>
							Padding Top
							<input type="number" name="pad-top" value="0" min="0">
						</label>
						<label>
							Padding Bottom
							<input type="number" name="pad-bottom" value="0" min="0">
						</label>
						<label>
							Padding Inline
							<input type="number" name="pad-inline" value="0" min="0">
						</label>
					</fieldset>
				</details>

				<details name="tabs" >
					<summary>Gaps</summary>
					<fieldset name="gaps">
						<label>
							Column Gap
							<input type="number" name="col-gap" value="1" min="0" step="0.5">
						</label>
						<label>
							Row Gap
							<input type="number" name="row-gap" value="1" min="0" step="0.5">
						</label>
					</fieldset>
				</details>

				<details name="tabs">
					<summary>Layout</summary>
					<fieldset name="layout">
						<label>Bleed
							<input type="number" name="bleed" value="0" min="-100" max="100">
						</label>
						<label>Bleed mode
							<select name="bleed-mode">
								<option value="none">None</option>
								<option value="full">Full</option>
								<option value="number" selected>Numeric</option>
							</select>
						</label>

						<label>
							Overflow
							<select name="overflow">
								<option value="unset">None</option>
								<option value="none">Hidden</option>
								<option value="preview">Preview</option>
								<option value="dynamic">Dynamic</option>
							</select>
						</label>
						<label>
							Theme
							<select name="theme">
								<option value="unset">None</option>
								<option value="primary">Primary</option>
								<option value="secondary">Secondary</option>
								<option value="tertiary">Tertiary</option>
							</select>
						</label>
						<label>
							Width Preset
							<select name="width">
								<option value="">None</option>
								<option value="xs">XS (20rem)</option>
								<option value="sm">SM (30rem)</option>
								<option value="md">MD (48rem)</option>
								<option value="lg">LG (64rem)</option>
								<option value="xl">XL (80rem)</option>
								<option value="xxl">XXL (96rem)</option>
							</select>
						</label>
					</fieldset>
				</details>

				<details name="tabs">
					<summary>Animation</summary>
					<fieldset name="animations">
						<label>
							Animation Name
							<select name="animationName">
								<option value="">None</option>

									<optgroup label="Fade">
										<option value="fade-in">fade-in</option><option value="fade-up">fade-up</option><option value="fade-down">fade-down</option><option value="fade-left">fade-left</option><option value="fade-right">fade-right</option><option value="fade-in-scale">fade-in-scale</option><option value="fade-out">fade-out</option><option value="fade-out-scale">fade-out-scale</option>
									</optgroup>

									<optgroup label="Bounce">
										<option value="bounce">bounce</option><option value="bounce-in-up">bounce-in-up</option><option value="bounce-in-down">bounce-in-down</option><option value="bounce-in-left">bounce-in-left</option><option value="bounce-in-right">bounce-in-right</option>
									</optgroup>

									<optgroup label="Zoom">
										<option value="zoom-in">zoom-in</option><option value="zoom-out">zoom-out</option><option value="zoom-in-rotate">zoom-in-rotate</option><option value="zoom-out-rotate">zoom-out-rotate</option>
									</optgroup>

									<optgroup label="Slide">
										<option value="slide-in">slide-in</option><option value="slide-out">slide-out</option><option value="slide-up">slide-up</option><option value="slide-down">slide-down</option>
									</optgroup>

									<optgroup label="Flip">
										<option value="flip-up">flip-up</option><option value="flip-down">flip-down</option><option value="flip-left">flip-left</option><option value="flip-right">flip-right</option><option value="flip-diagonal">flip-diagonal</option>
									</optgroup>

									<optgroup label="Reveal">
										<option value="reveal">reveal</option><option value="reveal-circle">reveal-circle</option><option value="reveal-polygon">reveal-polygon</option>
									</optgroup>

									<optgroup label="Other">
										<option value="opacity">opacity</option>
									</optgroup>

							</select>
						</label>
						<label>
							Animation Range
							<select name="animationRange">
								<option value="">Default</option>
								<option value="contain">Contain</option>
								<option value="cover">Cover</option>
								<option value="exit">Exit</option>
							</select>
						</label>
					</fieldset>
				</details>

				<details name="tabs">
					<summary>Advanced</summary>
					<fieldset name="advanced">
						<label>
							ARIA Label
							<input type="text" name="aria-label" value="">
						</label>
						<label>Gap Decorations
							<select name="gap-decorations">
								<option value="unset">None</option>
								<option value="cols">Columns</option>
								<option value="rows">Rows</option>
								<option value="cols rows">Both</option>
							</select>
						</label>
						<label>
							Intrinsic Size
							<select name="size">
								<option value="auto">auto</option>
								<option value="unset">None</option>
								<option value="200px">200px</option>
								<option value="300px">300px</option>
								<option value="400px">400px</option>
								<option value="500px">500px</option>
								<option value="600px">600px</option>
								<option value="50vh">50vh</option>
								<option value="75vh">75vh</option>
								<option value="100vh">100vh</option>
							</select>
						</label>
						<label>
							Self Alignment
							<select name="self">
								<option value="unset">None</option>
								<option value="auto">auto</option>
								<option value="start">start</option>
								<option value="end">end</option>
								<option value="center">center</option>
								<option value="stretch">stretch</option>
								<option value="baseline">baseline</option>
								<option value="self-start">self-start</option>
								<option value="self-end">self-end</option>
							</select>
						</label>
					</fieldset>
				</details>
			</tab-container>
		</tab-group>

		<fieldset name="iframe-width">
			<label>
				<input type="radio" name="iframe" value="100%" checked>
				<svg viewBox="0 0 24 24"><path d="M13 9a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1v8m-1 3h-6a1 1 0 0 1 -1 -1v-6"/><path d="M18 8v-3a1 1 0 0 0 -1 -1h-9m-4 0a1 1 0 0 0 -1 1v12a1 1 0 0 0 1 1h9"/><path d="M16 9h2"/><path d="M3 3l18 18"/></svg>
				<small>Full</small>
			</label>
			<label>
				<input type="radio" name="iframe" value="240">
				<svg viewBox="0 0 24 24"><path d="M6 5a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2v-14z"/><path d="M11 4h2"/><path d="M12 17v.01"/></svg>
				<small>XS</small>
			</label>
			<label>
				<input type="radio" name="iframe" value="380">
				<svg viewBox="0 0 24 24"><path d="M6 5a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2v-14z"/><path d="M11 4h2"/><path d="M12 17v.01"/></svg>
				<small>SM</small>
			</label>
			<label>
				<input type="radio" name="iframe" value="540">
				<svg viewBox="0 0 24 24"><path d="M5 4a1 1 0 0 1 1 -1h12a1 1 0 0 1 1 1v16a1 1 0 0 1 -1 1h-12a1 1 0 0 1 -1 -1v-16z"/><path d="M11 17a1 1 0 1 0 2 0a1 1 0 0 0 -2 0"/></svg>
				<small>MD</small>
			</label>
			<label>
				<input type="radio" name="iframe" value="720">
				<svg viewBox="0 0 24 24"><path d="M5 4a1 1 0 0 1 1 -1h12a1 1 0 0 1 1 1v16a1 1 0 0 1 -1 1h-12a1 1 0 0 1 -1 -1v-16z"/><path d="M11 17a1 1 0 1 0 2 0a1 1 0 0 0 -2 0"/></svg>
				<small>LG</small>
			</label>
			<label>
				<input type="radio" name="iframe" value="920">
				<svg viewBox="0 0 24 24"><path d="M3 4a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v12a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1v-12z"/><path d="M3 13h18"/><path d="M8 21h8"/><path d="M10 17l-.5 4"/><path d="M14 17l.5 4"/></svg>
				<small>XL</small>
			</label>
			<label>
				<input type="radio" name="iframe" value="1140">
				<svg viewBox="0 0 24 24"><path d="M11.5 17h-7.5a1 1 0 0 1 -1 -1v-12a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v9"/><path d="M3 13h18"/><path d="M8 21h3.5"/><path d="M10 17l-.5 4"/><path d="M20 21l2 -2l-2 -2"/><path d="M17 17l-2 2l2 2"/></svg>
				<small>XXL</small>
			</label>
		</fieldset>
	</form>
	<iframe id="preview-frame" src="layout.html"></iframe>
</layout-composer>


	<script>
		document.querySelectorAll('tab-container').forEach(container => {
  		container.style.setProperty('--tab-group-tabs', container.children.length);
		});

		const app = document.getElementById('app');
		const preview = document.querySelector('layout-composer iframe');

		preview.addEventListener('load', () => {
			const formData = new FormData(app);
			formData.forEach((value, name) => {
				sendToIframe(name, value);
			});
		});

		function sendToIframe(name, value) {
			preview.contentWindow.postMessage({
				type: 'updateLayout',
				name,
				value
			}, '*');
		}

		app.addEventListener('input', (event) => {
			const [name, value] = [event.target.name, event.target.value];

			if (name === 'iframe') {
				const width = value.endsWith('%') ? value : `${value}px`;
				preview.style.width = width;
				return;
			}

			if (name === 'bleed-mode') {
				app.elements.bleed.value = 0;
				sendToIframe('bleed-mode', value);
				if (value !== 'number') return;
			}

			sendToIframe(name, value);
		});

	</script>
</body>
</html>