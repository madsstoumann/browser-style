<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>CSP Manager - Initial Policy Demo</title>
	<link rel="stylesheet" href="/base.css">
	<script src="index.js" type="module"></script>
</head>
<body>

	<h1>CSP Manager: <code>initial-policy</code> Demo</h1>
	<p>This example demonstrates how to initialize the component with a predefined state using the <code>initial-policy</code> attribute.</p>


	<hr>

	<h2>Component Output:</h2>
	<div id="component-container"></div>

	<script>
		// NEW APPROACH: Client only specifies the directives they need!
		// The component loads all CSP specs from external JSON, but only enables what's here.

		// 1. Define ONLY the directives you want to enable and their custom values.
		//    This could come from a CMS, database, or configuration file.
		const clientPolicy = {
			"script-src": {
				"added": ["'unsafe-inline'", "cdn.example.com"]
			},
			"style-src": {
				"added": ["https://fonts.googleapis.com"]
			},
			"font-src": {
				"added": ["https://fonts.gstatic.com"]
			},
			"img-src": {
				"added": ["https://images.unsplash.com"]
			},
			"connect-src": {
				"added": ["api.example.com", "wss://websocket.example.com"]
			}
		};

		// 2. Stringify the policy (simulating server-side rendering or API response)
		const policyString = JSON.stringify(clientPolicy);

		// 3. Create the component and set the attribute
		const cspManager = document.createElement('csp-manager');
		cspManager.setAttribute('initial-policy', policyString);

		// 4. Add the component to the page
		document.getElementById('component-container').appendChild(cspManager);

		// ALTERNATIVE: You can also set the policy programmatically:
		// cspManager.policy = clientPolicy;
	</script>

</body>
</html>
